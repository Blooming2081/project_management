<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프로젝트 채팅 (Dark Mode)</title>
    <style>
        /* --- 다크 모드 스타일 시작 --- */
        :root {
            --dark-bg: #1e1e1e;         /* 기본 배경 */
            --dark-container-bg: #252526; /* 컨테이너 배경 */
            --dark-text: #cccccc;        /* 기본 텍스트 */
            --dark-border: #333333;       /* 테두리 */
            --dark-input-bg: #3c3c3c;     /* 입력 필드 배경 */
            --dark-input-text: #e0e0e0;   /* 입력 필드 텍스트 */
            --dark-my-message-bg: #0a4a7f; /* 내 메시지 배경 (어두운 파랑 계열) */
            --dark-my-message-text: #ffffff; /* 내 메시지 텍스트 */
            --dark-other-message-bg: #3a3a3a; /* 다른 사용자 메시지 배경 (어두운 회색) */
            --dark-other-message-text: #e0e0e0; /* 다른 사용자 메시지 텍스트 */
            --dark-sender-text: #aaaaaa;    /* 발신자 이름 색상 */
            --dark-timestamp-text: #888888; /* 타임스탬프 색상 */
            --dark-button-bg: #007bff;      /* 버튼 배경 (기존 유지 또는 변경) */
            --dark-button-hover-bg: #0056b3; /* 버튼 호버 배경 */
            --dark-button-disabled-bg: #555555; /* 비활성 버튼 배경 */
            --dark-connecting-text: #888888;  /* 연결 상태 텍스트 */
            --dark-header-text: #d4d4d4;    /* 헤더 텍스트 */
        }

        body {
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--dark-bg);
            color: var(--dark-text); /* 기본 텍스트 색상 */
        }
        #chat-container {
            max-width: 800px;
            margin: 20px auto;
            background-color: var(--dark-container-bg);
            border: 1px solid var(--dark-border);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.4); /* 그림자 약간 조정 */
            display: flex;
            flex-direction: column;
            height: calc(100vh - 100px);
            overflow: hidden;
        }
        h1 {
            text-align: center;
            color: var(--dark-header-text); /* 헤더 텍스트 색상 */
            font-size: 1.5em;
            padding: 15px;
            margin: 0;
            border-bottom: 1px solid var(--dark-border); /* 테두리 색상 */
        }
        #chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 15px;
            list-style: none;
            margin: 0;
            background-color: var(--dark-bg); /* 메시지 영역 배경 */
        }
        #chat-messages li {
            margin-bottom: 12px;
            padding: 8px 12px;
            border-radius: 15px;
            max-width: 75%;
            word-wrap: break-word;
            clear: both;
            color: var(--dark-text); /* 기본 메시지 텍스트 */
        }
        #chat-messages li span.sender {
            font-weight: bold;
            margin-right: 8px;
            color: var(--dark-sender-text); /* 발신자 색상 */
            display: block;
            font-size: 0.9em;
            margin-bottom: 3px;
        }
        #chat-messages li p.message-content {
             margin: 0;
             line-height: 1.4;
        }
        #chat-messages li small.timestamp {
            font-size: 0.75em;
            color: var(--dark-timestamp-text); /* 타임스탬프 색상 */
            display: block;
            text-align: right;
            margin-top: 4px;
        }
        /* 내 메시지 스타일 */
        #chat-messages li.my-message {
            background-color: var(--dark-my-message-bg);
            color: var(--dark-my-message-text); /* 텍스트 색상 */
            float: right;
            margin-left: auto;
        }
        #chat-messages li.my-message small.timestamp { text-align: right; color: #b0d4f1; } /* 타임스탬프 약간 밝게 */

        /* 다른 사용자 메시지 스타일 */
        #chat-messages li.other-message {
            background-color: var(--dark-other-message-bg);
            color: var(--dark-other-message-text); /* 텍스트 색상 */
            float: left;
            margin-right: auto;
        }
         #chat-messages li.other-message small.timestamp { text-align: right; }

        /* 시스템 메시지 스타일 */
        #chat-messages li.event-message {
            background-color: transparent;
            text-align: center;
            color: var(--dark-connecting-text); /* 연결 상태와 동일 색상 사용 */
            font-style: italic;
            font-size: 0.9em;
            width: 100%;
            max-width: 100%;
            float: none;
            margin: 10px 0;
        }

        #message-form {
            display: flex;
            padding: 15px;
            border-top: 1px solid var(--dark-border); /* 테두리 색상 */
            background-color: var(--dark-container-bg); /* 컨테이너와 동일 배경 */
        }
        #message-input {
            flex-grow: 1;
            padding: 10px 15px;
            border: 1px solid var(--dark-border); /* 테두리 색상 */
            border-radius: 20px;
            margin-right: 10px;
            font-size: 1em;
            background-color: var(--dark-input-bg); /* 입력 필드 배경 */
            color: var(--dark-input-text); /* 입력 필드 텍스트 */
        }
        #message-input::placeholder { /* 플레이스홀더 색상 */
            color: #888888;
        }
        #message-input:disabled {
             background-color: #444444; /* 비활성 배경 */
             color: #888888;
        }
        #send-button {
            padding: 10px 20px;
            border: none;
            background-color: var(--dark-button-bg);
            color: white;
            cursor: pointer;
            border-radius: 20px;
            font-size: 1em;
            transition: background-color 0.2s ease;
        }
        #send-button:hover { background-color: var(--dark-button-hover-bg); }
        #send-button:disabled {
             background-color: var(--dark-button-disabled-bg); /* 비활성 버튼 배경 */
             cursor: not-allowed;
        }
        #connecting-status {
            text-align: center;
            color: var(--dark-connecting-text); /* 연결 상태 텍스트 */
            padding: 10px;
            font-size: 0.9em;
            border-bottom: 1px solid var(--dark-border); /* 테두리 색상 */
            background-color: var(--dark-container-bg); /* 컨테이너와 동일 배경 */
        }
        /* --- 다크 모드 스타일 끝 --- */
    </style>
</head>
<body>
    <div id="chat-wrapper">
        <input type="hidden" id="project-id" th:value="${projectId}" />
        <input type="hidden" id="user-id" th:value="${userId}"/> <input type="hidden" id="user-name" th:value="${username}"/> <div id="chat-container">
            <h1><span th:text="${project?.name ?: '프로젝트'}">프로젝트 이름</span> 채팅</h1>
            <div id="connecting-status">연결 중...</div>
            <ul id="chat-messages">
                </ul>
            <form id="message-form" name="messageForm">
                <input type="text" id="message-input" placeholder="메시지를 입력하세요." autocomplete="off" disabled/>
                <button type="submit" id="send-button" disabled>전송</button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <script th:src="@{/js/chat.js}"></script> </body>
</html>